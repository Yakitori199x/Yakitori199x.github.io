<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Java 8 in action 学习笔记(3) - Hexo</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hexo"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hexo"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Java 8 in action 第八章、第九章学习笔记"><meta property="og:type" content="blog"><meta property="og:title" content="Java 8 in action 学习笔记(3)"><meta property="og:url" content="http://example.com/2021/01/05/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Java_8_in_action/Java_8_in_action_Chapter_08_09/"><meta property="og:site_name" content="Hexo"><meta property="og:description" content="Java 8 in action 第八章、第九章学习笔记"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:published_time" content="2021-01-05T14:43:18.980Z"><meta property="article:modified_time" content="2021-01-06T12:03:34.438Z"><meta property="article:author" content="John Doe"><meta property="article:tag" content="Java"><meta property="article:tag" content="读书笔记"><meta property="article:tag" content="Lambda"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2021/01/05/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Java_8_in_action/Java_8_in_action_Chapter_08_09/"},"headline":"Hexo","image":["http://example.com/img/og_image.png"],"datePublished":"2021-01-05T14:43:18.980Z","dateModified":"2021-01-06T12:03:34.438Z","author":{"@type":"Person","name":"John Doe"},"description":"Java 8 in action 第八章、第九章学习笔记"}</script><link rel="canonical" href="http://example.com/2021/01/05/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Java_8_in_action/Java_8_in_action_Chapter_08_09/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/vs2015.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-01-05</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2021-01-06</time></span><span class="level-item"><a class="link-muted" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a><span> / </span><a class="link-muted" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Java-8-in-action/">Java 8 in action</a></span><span class="level-item">8 minutes read (About 1247 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Java 8 in action 学习笔记(3)</h1><div class="content"><p>Java 8 in action 第八章、第九章学习笔记</p>
<a id="more"></a>

<h1 id="Chapter-8-Refactoring-testing-and-debugging"><a href="#Chapter-8-Refactoring-testing-and-debugging" class="headerlink" title="Chapter 8. Refactoring, testing, and debugging"></a>Chapter 8. Refactoring, testing, and debugging</h1><h2 id="Anonymous-classes-amp-Lambda-expressions-8-1-2"><a href="#Anonymous-classes-amp-Lambda-expressions-8-1-2" class="headerlink" title="Anonymous classes &amp; Lambda expressions (8.1.2)"></a>Anonymous classes &amp; Lambda expressions (8.1.2)</h2><ul>
<li>Inside an anonymous class, <strong>this</strong> refers to the <strong>anonymous class itself</strong>, but inside a lambda it refers to <strong>the enclosing class</strong>.</li>
<li>Anonymous classes are allowed to shadow variables from the enclosing class. Lambda expressions can’t (they’ll cause a compile error).</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Lambda</span></span><br><span class="line">Runnable r1 = () -&gt; &#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">2</span>; <span class="comment">// Compile error</span></span><br><span class="line">    System.out.println(a);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Anonymous class</span></span><br><span class="line">Runnable r2 = <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> a = <span class="number">2</span>; <span class="comment">// fine!</span></span><br><span class="line">        System.out.println(a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>Converting an anonymous class to a lambda expression can make the resulting code ambiguous in the context of overloading.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Task</span></span>&#123;</span><br><span class="line">    <span class="comment">// execute() has the same signature as run() in Runnable</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// there are 2 overloaded methods inside a class</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">(Runnable r)</span></span>&#123; r.run(); &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">(Task a)</span></span>&#123; r.execute(); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Anonymous class</span></span><br><span class="line"><span class="comment">// will call doSomething(Task)</span></span><br><span class="line">doSomething(<span class="keyword">new</span> Task() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Danger danger!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Lambda</span></span><br><span class="line"><span class="comment">// Both doSomething(Task) and doSomething(Runnable) match</span></span><br><span class="line">doSomething(() -&gt; System.out.println(<span class="string">&quot;Danger danger!!&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// The ambiguity can be solved by explicit cast</span></span><br><span class="line">doSomething((Task)() -&gt; System.out.println(<span class="string">&quot;Danger danger!!&quot;</span>));</span><br></pre></td></tr></table></figure>
<h2 id="Conditional-deferred-execution-8-1-5"><a href="#Conditional-deferred-execution-8-1-5" class="headerlink" title="Conditional deferred execution (8.1.5)"></a>Conditional deferred execution (8.1.5)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Example 1</span></span><br><span class="line"><span class="comment">// 1. The state of the logger (what level it supports) is exposed in the client code through the method isLoggable.</span></span><br><span class="line"><span class="comment">// 2. Query the state of the logger object every time before you can log a message</span></span><br><span class="line"><span class="comment">// 如果需要在多处进行log，就要将这个逻辑重复多次，相当繁琐</span></span><br><span class="line"><span class="keyword">if</span> (logger.isLoggable(Log.FINER))&#123;</span><br><span class="line">    logger.finer(<span class="string">&quot;Problem: &quot;</span> + generateDiagnostic());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Example 2</span></span><br><span class="line"><span class="comment">// 这种写法使得需要log不同级别的日志时，只需要修改一下Level.xxx即可。</span></span><br><span class="line"><span class="comment">// Unfortunately, there’s still an issue with this code. The logging message is always evaluated, even if the logger isn’t enabled for the message level passed as argument.</span></span><br><span class="line">logger.log(Level.FINER, <span class="string">&quot;Problem: &quot;</span> + generateDiagnostic());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Example 3</span></span><br><span class="line"><span class="comment">// lambda实现了当log level匹配时，log信息才会被生成。</span></span><br><span class="line"><span class="comment">// 如果你发现代码中多次出现了判断某个instance的状态，仅为了进入condition去调用某些method的模式，就可以考虑引入一个新的method和lambda，将上述操作封装在新method里。</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(Level level, Supplier&lt;String&gt; msgSupplier)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (logger.isLoggable(level))&#123;</span><br><span class="line">        log(level, msgSupplier.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">logger.log(Level.FINER, () -&gt; <span class="string">&quot;Problem: &quot;</span> + generateDiagnostic());</span><br></pre></td></tr></table></figure>
<h2 id="Design-Pattern-–-Strategy-8-2-1"><a href="#Design-Pattern-–-Strategy-8-2-1" class="headerlink" title="Design Pattern – Strategy (8.2.1)"></a>Design Pattern – Strategy (8.2.1)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过functional interface + lambda可以快速定义多个strategy。</span></span><br><span class="line"><span class="comment">// 同时，让client class调用interface中的abstract method。</span></span><br><span class="line"><span class="comment">// 这样就可以通过传入不同的lambda来改变method的行为，从而实现在runtime确定究竟执行哪一套逻辑。</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ValidationStrategy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(String s)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Validator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ValidationStrategy strategy;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Validator</span> <span class="params">(ValidationStrategy v)</span> <span class="keyword">this</span>.strategy </span>= v;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">validate</span> <span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> strategy.execute(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Validator numericValidator = <span class="keyword">new</span> Validator((String s) -&gt; s.matches(<span class="string">&quot;[0-9]+&quot;</span>));</span><br><span class="line"><span class="keyword">boolean</span> b1 = numericValidator.validate(<span class="string">&quot;aaaa&quot;</span>); <span class="comment">// return false</span></span><br><span class="line">Validator lowerCaseValidator = <span class="keyword">new</span> Validator((String s) -&gt; s.matches(<span class="string">&quot;\\d+&quot;</span>));</span><br><span class="line"><span class="keyword">boolean</span> b2 = lowerCaseValidator.validate(<span class="string">&quot;bbbb&quot;</span>); <span class="comment">// return true</span></span><br></pre></td></tr></table></figure>
<h2 id="Chain-of-responsibility-8-2-4"><a href="#Chain-of-responsibility-8-2-4" class="headerlink" title="Chain of responsibility (8.2.4)"></a>Chain of responsibility (8.2.4)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// One processing object may do some work and pass the result to another object, which then also does some work and passes it on to yet another processing object, and so on.</span></span><br><span class="line"><span class="comment">// Generally, this pattern is implemented by defining an abstract class representing a processing object that defines a field to keep track of a successor. Once it has finished its work, the processing object hands over its work to its successor.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// abstract class represents the processing object</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ProcessingObject</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// to track the successor object which will do further processing based on current result</span></span><br><span class="line">    <span class="keyword">protected</span> ProcessingObject&lt;T&gt; successor;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSuccessor</span><span class="params">(ProcessingObject&lt;T&gt; successor)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.successor = successor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">handle</span><span class="params">(T input)</span> </span>&#123;</span><br><span class="line">        T r = handleWork(input);</span><br><span class="line">        <span class="keyword">if</span> (successor != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> successor.handle(r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">protected</span> T <span class="title">handleWork</span><span class="params">(T input)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeaderTextProcessing</span> <span class="keyword">extends</span> <span class="title">ProcessingObject</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">handleWork</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;From Raoul, Mario and Alan: &quot;</span> + text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpellCheckerProcessing</span> <span class="keyword">extends</span> <span class="title">ProcessingObject</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">handleWork</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> text.replaceAll(<span class="string">&quot;labda&quot;</span>, <span class="string">&quot;lambda&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use in client</span></span><br><span class="line">ProcessingObject&lt;String&gt; p1 = <span class="keyword">new</span> HeaderTextProcessing();</span><br><span class="line">ProcessingObject&lt;String&gt; p2 = <span class="keyword">new</span> SpellCheckerProcessing();</span><br><span class="line">p1.setSuccessor(p2);</span><br><span class="line">String result1 = p1.handle(<span class="string">&quot;Aren&#x27;t labdas really sexy?!!&quot;</span>); <span class="comment">// Result: From Raoul, Mario and Alan: Aren&#x27;t lambda really sexy?!!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Turn to lambda implementation</span></span><br><span class="line">UnaryOperator&lt;String&gt; headerProcessing = </span><br><span class="line">    (String text) -&gt; <span class="string">&quot;From Raoul, Mario and Alan: &quot;</span> + text;</span><br><span class="line">UnaryOperator&lt;String&gt; spellCheckerProcessing =</span><br><span class="line">    (String text) -&gt; text.replaceAll(<span class="string">&quot;labda&quot;</span>, <span class="string">&quot;lambda&quot;</span>);</span><br><span class="line">Function&lt;String, String&gt; pipeline = headerProcessing.andThen(spellCheckerProcessing);</span><br><span class="line">String result2 = pipeline.apply(<span class="string">&quot;Aren&#x27;t labdas really sexy?!!&quot;</span>);</span><br></pre></td></tr></table></figure>
<h1 id="Chapter-9-Default-methods"><a href="#Chapter-9-Default-methods" class="headerlink" title="Chapter 9. Default methods"></a>Chapter 9. Default methods</h1><h2 id="Binary-Compatible-9-1-2"><a href="#Binary-Compatible-9-1-2" class="headerlink" title="Binary Compatible (9.1.2)"></a>Binary Compatible (9.1.2)</h2><p>Adding a new method to an interface is binary compatible; this means existing class file implementations <strong>will still run without the implementation of the new method</strong>, if there’s <strong>no attempt to recompile them</strong>.</p>
<ul>
<li>If the user modify the code to use the new method (say setRelativeSize), an error will be thrown at <strong>run-time</strong> because the setRelativeSize method isn’t implemented:</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread <span class="string">&quot;main&quot;</span> java.lang.AbstractMethodError:</span><br><span class="line">	lambdasinaction.chap9.Ellipse.setRelativeSize(II)V</span><br></pre></td></tr></table></figure>
<ul>
<li>If the user tries to rebuild his entire application, he’ll get the following compile error:</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lambdasinaction/chap9/Ellipse.java:<span class="number">6</span>: error: <span class="function">Ellipse is not <span class="keyword">abstract</span> and does not override <span class="keyword">abstract</span> method <span class="title">setRelativeSize</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>)</span> in Resizable</span></span><br></pre></td></tr></table></figure>
<h2 id="Source-compatibility-amp-Behavioral-compatibility"><a href="#Source-compatibility-amp-Behavioral-compatibility" class="headerlink" title="Source compatibility &amp; Behavioral compatibility"></a>Source compatibility &amp; Behavioral compatibility</h2><ul>
<li><strong>Source compatibility</strong>: source compatibility means an existing program will still compile after introducing a change.<br>(e.g. adding a method to an interface isn’t source compatible)</li>
<li>Behavioral compatibility: behavioral compatibility means running a program after a change with the same inputs results in the same behavior.<br>(e.g. adding a method to an interface is behavioral compatible because the method is never called in the program)</li>
</ul>
<h2 id="Resolution-rules-9-4"><a href="#Resolution-rules-9-4" class="headerlink" title="Resolution rules (9.4)"></a>Resolution rules (9.4)</h2><ol>
<li>Classes always win. A method declaration in the <strong>class</strong> or a <strong>superclass</strong> takes priority over any default method declaration.</li>
<li>Otherwise, <strong>sub-interfaces</strong> win: the method with the same signature in <strong>the most specific default-providing interface</strong> is selected. (If B extends A, B is more specific than A).</li>
<li>Finally, if the choice is still ambiguous, the class inheriting from multiple interfaces has to explicitly select which default method implementation to use by overriding it and calling the desired method explicitly.</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Example 1</span></span><br><span class="line"><span class="comment">// A is an interface with method hello(), B is another interface extends A and override hello(), D is a class implements A</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">D</span> <span class="keyword">implements</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">D</span> <span class="keyword">implements</span> <span class="title">B</span>, <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span> <span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// hello() from B is called</span></span><br><span class="line">        <span class="comment">// Because D doesn’t override hello although it has a default method from interface A. And B is more specfic than A.</span></span><br><span class="line">        <span class="keyword">new</span> C().hello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Example 2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello from A&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello from B&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Error: class C inherits unrelated defaults for hello() from types B and A.</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">implements</span> <span class="title">B</span>, <span class="title">A</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Solution: use X.super.m() where X is the superinterface whose method m you want to call.</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">implements</span> <span class="title">B</span>, <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        B.<span class="keyword">super</span>.hello(); <span class="comment">// explicitly choose to call hello() from B</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div><div class="article-licensing box"><div class="licensing-title"><p>Java 8 in action 学习笔记(3)</p><p><a href="http://example.com/2021/01/05/读书笔记/Java_8_in_action/Java_8_in_action_Chapter_08_09/">http://example.com/2021/01/05/读书笔记/Java_8_in_action/Java_8_in_action_Chapter_08_09/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>John Doe</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2021-01-05</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2021-01-06</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/Java/">Java, </a><a class="link-muted" rel="tag" href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记, </a><a class="link-muted" rel="tag" href="/tags/Lambda/">Lambda </a></div></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/01/05/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Java_8_in_action/Java_8_in_action_Chapter_10_11/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Java 8 in action 学习笔记(4)</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/01/05/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Java_8_in_action/Java_8_in_action_Chapter_06_07/"><span class="level-item">Java 8 in action 学习笔记(2)</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Your name"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Your name</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Your location</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">10</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">16</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Chapter-8-Refactoring-testing-and-debugging"><span class="level-left"><span class="level-item">1</span><span class="level-item">Chapter 8. Refactoring, testing, and debugging</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Anonymous-classes-amp-Lambda-expressions-8-1-2"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">Anonymous classes &amp; Lambda expressions (8.1.2)</span></span></a></li><li><a class="level is-mobile" href="#Conditional-deferred-execution-8-1-5"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">Conditional deferred execution (8.1.5)</span></span></a></li><li><a class="level is-mobile" href="#Design-Pattern-–-Strategy-8-2-1"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">Design Pattern – Strategy (8.2.1)</span></span></a></li><li><a class="level is-mobile" href="#Chain-of-responsibility-8-2-4"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">Chain of responsibility (8.2.4)</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Chapter-9-Default-methods"><span class="level-left"><span class="level-item">2</span><span class="level-item">Chapter 9. Default methods</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Binary-Compatible-9-1-2"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">Binary Compatible (9.1.2)</span></span></a></li><li><a class="level is-mobile" href="#Source-compatibility-amp-Behavioral-compatibility"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Source compatibility &amp; Behavioral compatibility</span></span></a></li><li><a class="level is-mobile" href="#Resolution-rules-9-4"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">Resolution rules (9.4)</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a><p class="is-size-7"><span>&copy; 2021 John Doe</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>